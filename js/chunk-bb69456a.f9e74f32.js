(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bb69456a"],{"102b":function(e,t,n){"use strict";n("5d80")},"1c1e":function(e,t,n){},2375:function(e,t,n){"use strict";var r=n("7a23"),a=Object(r["H"])("data-v-bb4a7a2a");Object(r["s"])("data-v-bb4a7a2a");var c={class:"spinner"},i=Object(r["g"])("div",{class:"bouncing-loader"},[Object(r["g"])("div"),Object(r["g"])("div"),Object(r["g"])("div")],-1);Object(r["q"])();var s=a((function(e,t){return Object(r["p"])(),Object(r["d"])("div",c,[i])}));n("102b");const o={};o.render=s,o.__scopeId="data-v-bb4a7a2a";t["a"]=o},5652:function(e,t,n){"use strict";n.r(t);n("b0c0");var r=n("7a23"),a=Object(r["H"])("data-v-dcf11c4a");Object(r["s"])("data-v-dcf11c4a");var c={class:"container py-5"},i={class:"my-4"},s={class:"form-row"},o={class:"col-auto"},u={class:"col-auto"},d={key:1,class:"table"},b=Object(r["g"])("thead",{class:"thead-dark"},[Object(r["g"])("tr",null,[Object(r["g"])("th",{scope:"col",width:"60"}," # "),Object(r["g"])("th",{scope:"col"}," Category Name "),Object(r["g"])("th",{scope:"col",width:"210"}," Action ")])],-1),g={scope:"row"},l={class:"position-relative"},f={class:"d-flex justify-content-between"};Object(r["q"])();var m=a((function(e,t,n,a,m,p){var j=Object(r["w"])("AdminNav"),O=Object(r["w"])("Spinner");return Object(r["p"])(),Object(r["d"])("div",c,[Object(r["g"])(j),Object(r["g"])("form",i,[Object(r["g"])("div",s,[Object(r["g"])("div",o,[Object(r["F"])(Object(r["g"])("input",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return m.newCategoryName=e}),type:"text",class:"form-control",placeholder:"新增餐廳類別..."},null,512),[[r["B"],m.newCategoryName]])]),Object(r["g"])("div",u,[Object(r["g"])("button",{type:"button",class:"btn btn-primary",disabled:m.isProcessing,onClick:t[2]||(t[2]=Object(r["G"])((function(){return p.createCategory&&p.createCategory.apply(p,arguments)}),["stop","prevent"]))}," 新增 ",8,["disabled"])])])]),m.isLoading?(Object(r["p"])(),Object(r["d"])(O,{key:0})):(Object(r["p"])(),Object(r["d"])("table",d,[b,Object(r["g"])("tbody",null,[(Object(r["p"])(!0),Object(r["d"])(r["a"],null,Object(r["v"])(m.categories,(function(e){return Object(r["p"])(),Object(r["d"])("tr",{key:e.id},[Object(r["g"])("th",g,Object(r["y"])(e.id),1),Object(r["g"])("td",l,[Object(r["F"])(Object(r["g"])("div",{class:"category-name"},Object(r["y"])(e.name),513),[[r["C"],!e.isEditing]]),Object(r["F"])(Object(r["g"])("input",{"onUpdate:modelValue":function(t){return e.name=t},type:"text",class:"form-control"},null,8,["onUpdate:modelValue"]),[[r["C"],e.isEditing],[r["B"],e.name]]),Object(r["F"])(Object(r["g"])("span",{class:"cancel",onClick:Object(r["G"])((function(t){return p.handleCancel(e.id)}),["stop","prevent"])}," ✕ ",8,["onClick"]),[[r["C"],e.isEditing]])]),Object(r["g"])("td",f,[Object(r["F"])(Object(r["g"])("button",{type:"button",class:"btn btn-link mr-2",onClick:Object(r["G"])((function(t){return p.toggleIsEditing(e.id)}),["stop","prevent"])}," Edit ",8,["onClick"]),[[r["C"],!e.isEditing]]),Object(r["F"])(Object(r["g"])("button",{type:"button",class:"btn btn-link mr-2",onClick:Object(r["G"])((function(t){return p.updateCategory({categoryId:e.id,name:e.name})}),["stop","prevent"])}," Save ",8,["onClick"]),[[r["C"],e.isEditing]]),Object(r["g"])("button",{type:"button",class:"btn btn-link mr-2",onClick:Object(r["G"])((function(t){return p.deleteCategory(e.id)}),["stop","prevent"])}," Delete ",8,["onClick"])])])})),128))])]))])})),p=n("5530"),j=n("1da1"),O=(n("96cf"),n("d81d"),n("4de4"),n("e04c")),v=n("be6c"),h=n("2fa3"),w=n("2375"),y={name:"AdminCategories",components:{AdminNav:O["a"],Spinner:w["a"]},data:function(){return{categories:[],newCategoryName:"",isProcessing:!1,isLoading:!0}},created:function(){this.fetchCategories()},methods:{fetchCategories:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v["a"].categories.get();case 3:if(n=t.sent,r=n.data,"error"!==r.status){t.next=7;break}throw new Error(r.message);case 7:e.categories=r.categories.map((function(e){return Object(p["a"])(Object(p["a"])({},e),{},{isEditing:!1,nameCached:""})})),e.isLoading=!1,t.next=16;break;case 11:t.prev=11,t.t0=t["catch"](0),console.error(t.t0.message),e.isLoading=!1,h["a"].fire({icon:"error",title:"無法取得餐廳類別，請稍後再試"});case 16:case"end":return t.stop()}}),t,null,[[0,11]])})))()},createCategory:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isProcessing=!0,t.next=4,v["a"].categories.create({name:e.newCategoryName});case 4:if(n=t.sent,r=n.data,"error"!==r.status){t.next=8;break}throw new Error(r.message);case 8:e.categories.push({id:r.categoryId,name:e.newCategoryName,isEditing:!1}),e.isProcessing=!1,e.newCategoryName="",t.next=18;break;case 13:t.prev=13,t.t0=t["catch"](0),console.error(t.t0.message),e.isProcessing=!1,h["a"].fire({icon:"error",title:"無法新增餐廳類別，請稍後再試"});case 18:case"end":return t.stop()}}),t,null,[[0,13]])})))()},deleteCategory:function(e){var t=this;return Object(j["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,v["a"].categories.delete({categoryId:e});case 3:if(r=n.sent,a=r.data,"error"!==a.status){n.next=7;break}throw new Error(a.message);case 7:t.categories=t.categories.filter((function(t){return t.id!==e})),h["a"].fire({icon:"success",title:"成功刪除餐廳類別"}),n.next=15;break;case 11:n.prev=11,n.t0=n["catch"](0),console.error(n.t0.message),h["a"].fire({icon:"error",title:"無法刪除餐廳類別，請稍後再試"});case 15:case"end":return n.stop()}}),n,null,[[0,11]])})))()},updateCategory:function(e){var t=this;return Object(j["a"])(regeneratorRuntime.mark((function n(){var r,a,c,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.categoryId,a=e.name,n.prev=1,n.next=4,v["a"].categories.update({categoryId:r,name:a});case 4:if(c=n.sent,i=c.data,"error"!==i.status){n.next=8;break}throw new Error(i.message);case 8:t.toggleIsEditing(r),n.next=15;break;case 11:n.prev=11,n.t0=n["catch"](1),console.error(n.t0.message),h["a"].fire({icon:"error",title:"無法更新餐廳類別，請稍後再試"});case 15:case"end":return n.stop()}}),n,null,[[1,11]])})))()},toggleIsEditing:function(e){this.categories=this.categories.map((function(t){return t.id===e?Object(p["a"])(Object(p["a"])({},t),{},{isEditing:!t.isEditing,nameCached:t.name}):t}))},handleCancel:function(e){this.categories=this.categories.map((function(t){return t.id===e?Object(p["a"])(Object(p["a"])({},t),{},{name:t.nameCached}):t})),this.toggleIsEditing(e)}}};n("5a25");y.render=m,y.__scopeId="data-v-dcf11c4a";t["default"]=y},"5a25":function(e,t,n){"use strict";n("1c1e")},"5d80":function(e,t,n){},be6c:function(e,t,n){"use strict";n("b0c0");var r=n("2fa3");t["a"]={categories:{get:function(){return r["b"].get("/admin/categories")},create:function(e){var t=e.name;return r["b"].post("/admin/categories",{name:t})},update:function(e){var t=e.categoryId,n=e.name;return r["b"].put("/admin/categories/".concat(t),{name:n})},delete:function(e){var t=e.categoryId;return r["b"].delete("/admin/categories/".concat(t))}},restaurants:{create:function(e){var t=e.formData;return r["b"].post("/admin/restaurants",t)},get:function(){return r["b"].get("/admin/restaurants")},getDetail:function(e){var t=e.restaurantId;return r["b"].get("/admin/restaurants/".concat(t))},update:function(e){var t=e.restaurantId,n=e.formData;return r["b"].put("/admin/restaurants/".concat(t),n)},delete:function(e){var t=e.restaurantId;return r["b"].delete("/admin/restaurants/".concat(t))}},users:{get:function(){return r["b"].get("/admin/users")},update:function(e){var t=e.userId,n=e.isAdmin;return r["b"].put("/admin/users/".concat(t),{isAdmin:n})}}}},d81d:function(e,t,n){"use strict";var r=n("23e7"),a=n("b727").map,c=n("1dde"),i=c("map");r({target:"Array",proto:!0,forced:!i},{map:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},e04c:function(e,t,n){"use strict";var r=n("7a23"),a={class:"mb-3"},c=Object(r["g"])("h1",null,"餐廳後台",-1),i=Object(r["f"])(" Restaurants "),s=Object(r["f"])(" | "),o=Object(r["f"])("Categories"),u=Object(r["f"])(" | "),d=Object(r["f"])(" Users ");function b(e,t,n,b,g,l){var f=Object(r["w"])("router-link");return Object(r["p"])(),Object(r["d"])("div",a,[c,Object(r["g"])(f,{to:"/admin/restaurants"},{default:Object(r["E"])((function(){return[i]})),_:1}),s,Object(r["g"])(f,{to:"/admin/categories"},{default:Object(r["E"])((function(){return[o]})),_:1}),u,Object(r["g"])(f,{to:"/admin/users"},{default:Object(r["E"])((function(){return[d]})),_:1})])}var g={name:"AdminNav"};g.render=b;t["a"]=g}}]);
//# sourceMappingURL=chunk-bb69456a.f9e74f32.js.map