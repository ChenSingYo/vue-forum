{"version":3,"sources":["webpack:///./src/views/RestaurantsTop.vue","webpack:///./src/views/RestaurantsTop.vue?3ef1","webpack:///./node_modules/core-js/modules/es.array.map.js"],"names":["class","restaurants","restaurant","key","id","style","to","src","image","alt","name","FavoriteCount","description","isFavorited","type","deleteFavorite","addFavorite","components","NavTabs","data","created","this","fetchTopRestaurants","methods","getTopRestaurants","status","Error","message","console","log","fire","icon","title","restaurantId","users","map","error","sort","a","b","massage","render","$","$map","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT","target","proto","forced","callbackfn","arguments","length","undefined"],"mappings":"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","file":"js/chunk-6ca49a1e.5f460c19.js","sourcesContent":["<template>\n  <div class=\"container py-5\">\n    <NavTabs />\n    <h1 class=\"mt-5\">\n      人氣餐廳\n    </h1>\n    <hr />\n    <div\n      v-for=\"restaurant in restaurants\"\n      :key=\"restaurant.id\"\n      class=\"card mb-3\"\n      style=\"max-width: 540px;margin: auto;\"\n    >\n      <div class=\"row no-gutters\">\n        <div class=\"col-md-4\">\n          <router-link\n            :to=\"{ name: 'restaurant', params: { id: restaurant.id } }\"\n          >\n            <img class=\"card-img\" :src=\"restaurant.image\" alt=\"image\" />\n          </router-link>\n        </div>\n        <div class=\"col-md-8\">\n          <div class=\"card-body\">\n            <h5 class=\"card-title\">\n              {{ restaurant.name }}\n            </h5>\n            <span class=\"badge badge-secondary\"\n              >收藏數：{{ restaurant.FavoriteCount }}</span\n            >\n            <p class=\"card-text\">\n              {{ restaurant.description }}\n            </p>\n            <router-link\n              :to=\"{ name: 'restaurant', params: { id: restaurant.id } }\"\n              class=\"btn btn-primary mr-2\"\n              >Show</router-link\n            >\n\n            <button\n              v-if=\"restaurant.isFavorited\"\n              type=\"button\"\n              class=\"btn btn-danger mr-2\"\n              @click.stop.prevent=\"deleteFavorite(restaurant.id)\"\n            >\n              移除最愛\n            </button>\n            <button\n              v-else\n              type=\"button\"\n              class=\"btn btn-primary\"\n              @click.stop.prevent=\"addFavorite(restaurant.id)\"\n            >\n              加到最愛\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport NavTabs from './../components/NavTabs.vue'\nimport restaurantsAPI from './../apis/restaurants'\nimport usersAPI from './../apis/users'\nimport { Toast } from '@/utils/helpers'\n\nexport default {\n  name: 'RestaurantsTop',\n  components: {\n    NavTabs\n  },\n  data () {\n    return {\n      restaurants: []\n    }\n  },\n  created () {\n    this.fetchTopRestaurants()\n  },\n  methods: {\n    async fetchTopRestaurants () {\n      try {\n        const { data } = await restaurantsAPI.getTopRestaurants()\n        if (data.status === 'error') {\n          throw new Error(data.message)\n        }\n        this.restaurants = data.restaurants\n      } catch (e) {\n        console.log(e.message)\n        Toast.fire({\n          icon: 'error',\n          title: '無法取得人氣餐廳，請稍後再試'\n        })\n      }\n    },\n    async addFavorite (restaurantId) {\n      try {\n        const { data } = await usersAPI.addFavorite({ restaurantId })\n        if (data.status !== 'success') {\n          throw new Error(data.message)\n        }\n        this.restaurants = this.restaurants.map(restaurant => {\n          if (restaurant.id !== restaurantId) {\n            return restaurant\n          } else {\n            return {\n              ...restaurant,\n              FavoriteCount: restaurant.FavoriteCount + 1,\n              isFavorited: true\n            }\n          }\n        })\n      } catch (e) {\n        console.error(e.message)\n        Toast.fire({\n          icon: 'error',\n          title: '無法取得人氣餐廳，請稍後再試'\n        })\n      }\n    },\n    async deleteFavorite (restaurantId) {\n      try {\n        const { data } = await usersAPI.deleteFavorite({ restaurantId })\n        if (data.status !== 'success') {\n          throw new Error(data.message)\n        }\n        console.log(data)\n        this.restaurants = this.restaurants\n          .map(restaurant => {\n            if (restaurant.id !== restaurantId) {\n              return restaurant\n            }\n            return {\n              ...restaurant,\n              FavoriteCount: restaurant.FavoriteCount - 1,\n              isFavorited: false\n            }\n          })\n          .sort((a, b) => b.FavoriteCount - a.FavoriteCount)\n      } catch (e) {\n        console.log(e.massage)\n        Toast.fire({\n          icon: 'error',\n          title: '無法將餐廳移除最愛，請稍後再試'\n        })\n      }\n    }\n  }\n}\n</script>\n","import { render } from \"./RestaurantsTop.vue?vue&type=template&id=c81253de\"\nimport script from \"./RestaurantsTop.vue?vue&type=script&lang=js\"\nexport * from \"./RestaurantsTop.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n"],"sourceRoot":""}