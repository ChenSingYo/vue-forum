(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ca49a1e"],{"571a":function(t,e,r){"use strict";r.r(e);r("b0c0"),r("a4d3"),r("e01a");var a=r("7a23"),n={class:"container py-5"},c=Object(a["g"])("h1",{class:"mt-5"}," 人氣餐廳 ",-1),s=Object(a["g"])("hr",null,null,-1),o={class:"row no-gutters"},i={class:"col-md-4"},u={class:"col-md-8"},d={class:"card-body"},b={class:"card-title"},l={class:"badge badge-secondary"},p={class:"card-text"},v=Object(a["f"])("Show");function m(t,e,r,m,j,O){var g=Object(a["w"])("NavTabs"),f=Object(a["w"])("router-link");return Object(a["p"])(),Object(a["d"])("div",n,[Object(a["g"])(g),c,s,(Object(a["p"])(!0),Object(a["d"])(a["a"],null,Object(a["v"])(j.restaurants,(function(t){return Object(a["p"])(),Object(a["d"])("div",{key:t.id,class:"card mb-3",style:{"max-width":"540px",margin:"auto"}},[Object(a["g"])("div",o,[Object(a["g"])("div",i,[Object(a["g"])(f,{to:{name:"restaurant",params:{id:t.id}}},{default:Object(a["E"])((function(){return[Object(a["g"])("img",{class:"card-img",src:t.image,alt:"image"},null,8,["src"])]})),_:2},1032,["to"])]),Object(a["g"])("div",u,[Object(a["g"])("div",d,[Object(a["g"])("h5",b,Object(a["y"])(t.name),1),Object(a["g"])("span",l,"收藏數："+Object(a["y"])(t.FavoriteCount),1),Object(a["g"])("p",p,Object(a["y"])(t.description),1),Object(a["g"])(f,{to:{name:"restaurant",params:{id:t.id}},class:"btn btn-primary mr-2"},{default:Object(a["E"])((function(){return[v]})),_:2},1032,["to"]),t.isFavorited?(Object(a["p"])(),Object(a["d"])("button",{key:0,type:"button",class:"btn btn-danger mr-2",onClick:Object(a["G"])((function(e){return O.deleteFavorite(t.id)}),["stop","prevent"])}," 移除最愛 ",8,["onClick"])):(Object(a["p"])(),Object(a["d"])("button",{key:1,type:"button",class:"btn btn-primary",onClick:Object(a["G"])((function(e){return O.addFavorite(t.id)}),["stop","prevent"])}," 加到最愛 ",8,["onClick"]))])])])])})),128))])}var j=r("5530"),O=r("1da1"),g=(r("d81d"),r("96cf"),r("8bb1")),f=r("c4c3"),h=r("4cce"),w=r("2fa3"),k={name:"RestaurantsTop",components:{NavTabs:g["a"]},data:function(){return{restaurants:[]}},created:function(){this.fetchTopRestaurants()},methods:{fetchTopRestaurants:function(){var t=this;return Object(O["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f["a"].getTopRestaurants();case 3:if(r=e.sent,a=r.data,"error"!==a.status){e.next=7;break}throw new Error(a.message);case 7:t.restaurants=a.restaurants,e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](0),console.log(e.t0.message),w["a"].fire({icon:"error",title:"無法取得人氣餐廳，請稍後再試"});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))()},addFavorite:function(t){var e=this;return Object(O["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,h["a"].addFavorite({restaurantId:t});case 3:if(a=r.sent,n=a.data,"success"===n.status){r.next=7;break}throw new Error(n.message);case 7:e.restaurants=e.restaurants.map((function(e){return e.id!==t?e:Object(j["a"])(Object(j["a"])({},e),{},{FavoriteCount:e.FavoriteCount+1,isFavorited:!0})})),r.next=14;break;case 10:r.prev=10,r.t0=r["catch"](0),console.error(r.t0.message),w["a"].fire({icon:"error",title:"無法取得人氣餐廳，請稍後再試"});case 14:case"end":return r.stop()}}),r,null,[[0,10]])})))()},deleteFavorite:function(t){var e=this;return Object(O["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,h["a"].deleteFavorite({restaurantId:t});case 3:if(a=r.sent,n=a.data,"success"===n.status){r.next=7;break}throw new Error(n.message);case 7:console.log(n),e.restaurants=e.restaurants.map((function(e){return e.id!==t?e:Object(j["a"])(Object(j["a"])({},e),{},{FavoriteCount:e.FavoriteCount-1,isFavorited:!1})})).sort((function(t,e){return e.FavoriteCount-t.FavoriteCount})),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.log(r.t0.massage),w["a"].fire({icon:"error",title:"無法將餐廳移除最愛，請稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()}}};k.render=m;e["default"]=k},d81d:function(t,e,r){"use strict";var a=r("23e7"),n=r("b727").map,c=r("1dde"),s=c("map");a({target:"Array",proto:!0,forced:!s},{map:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-6ca49a1e.5f460c19.js.map