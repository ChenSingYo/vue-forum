(function(e){function t(t){for(var a,n,u=t[0],o=t[1],i=t[2],d=0,b=[];d<u.length;d++)n=u[d],Object.prototype.hasOwnProperty.call(c,n)&&c[n]&&b.push(c[n][0]),c[n]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);l&&l(t);while(b.length)b.shift()();return s.push.apply(s,i||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],a=!0,n=1;n<r.length;n++){var u=r[n];0!==c[u]&&(a=!1)}a&&(s.splice(t--,1),e=o(o.s=r[0]))}return e}var a={},n={app:0},c={app:0},s=[];function u(e){return o.p+"js/"+({}[e]||e)+"."+{"chunk-05fcd4b4":"c864a784","chunk-0ebdf657":"370b05d2","chunk-295109e3":"bd33d44e","chunk-2d0ab43a":"17a3763b","chunk-2d0d338e":"1dd35232","chunk-2d228901":"71e58251","chunk-3c50f41a":"6fb58d59","chunk-3f0a9877":"57ff498a","chunk-5ac8fa57":"26f9298d","chunk-1840e7d8":"b7532ac6","chunk-3b6de194":"632a7876","chunk-6ca49a1e":"5f460c19","chunk-bb69456a":"f9e74f32","chunk-c002a722":"f56e256b","chunk-d55d3ce2":"12e3fa3c"}[e]+".js"}function o(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(e){var t=[],r={"chunk-05fcd4b4":1,"chunk-0ebdf657":1,"chunk-295109e3":1,"chunk-3f0a9877":1,"chunk-5ac8fa57":1,"chunk-1840e7d8":1,"chunk-3b6de194":1,"chunk-bb69456a":1};n[e]?t.push(n[e]):0!==n[e]&&r[e]&&t.push(n[e]=new Promise((function(t,r){for(var a="css/"+({}[e]||e)+"."+{"chunk-05fcd4b4":"4caf4fbd","chunk-0ebdf657":"4caf4fbd","chunk-295109e3":"4caf4fbd","chunk-2d0ab43a":"31d6cfe0","chunk-2d0d338e":"31d6cfe0","chunk-2d228901":"31d6cfe0","chunk-3c50f41a":"31d6cfe0","chunk-3f0a9877":"4caf4fbd","chunk-5ac8fa57":"4caf4fbd","chunk-1840e7d8":"7e898d4c","chunk-3b6de194":"e010ff20","chunk-6ca49a1e":"31d6cfe0","chunk-bb69456a":"653e9520","chunk-c002a722":"31d6cfe0","chunk-d55d3ce2":"31d6cfe0"}[e]+".css",c=o.p+a,s=document.getElementsByTagName("link"),u=0;u<s.length;u++){var i=s[u],d=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(d===a||d===c))return t()}var b=document.getElementsByTagName("style");for(u=0;u<b.length;u++){i=b[u],d=i.getAttribute("data-href");if(d===a||d===c)return t()}var l=document.createElement("link");l.rel="stylesheet",l.type="text/css",l.onload=t,l.onerror=function(t){var a=t&&t.target&&t.target.src||c,s=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=a,delete n[e],l.parentNode.removeChild(l),r(s)},l.href=c;var p=document.getElementsByTagName("head")[0];p.appendChild(l)})).then((function(){n[e]=0})));var a=c[e];if(0!==a)if(a)t.push(a[2]);else{var s=new Promise((function(t,r){a=c[e]=[t,r]}));t.push(a[2]=s);var i,d=document.createElement("script");d.charset="utf-8",d.timeout=120,o.nc&&d.setAttribute("nonce",o.nc),d.src=u(e);var b=new Error;i=function(t){d.onerror=d.onload=null,clearTimeout(l);var r=c[e];if(0!==r){if(r){var a=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;b.message="Loading chunk "+e+" failed.\n("+a+": "+n+")",b.name="ChunkLoadError",b.type=a,b.request=n,r[1](b)}c[e]=void 0}};var l=setTimeout((function(){i({type:"timeout",target:d})}),12e4);d.onerror=d.onload=i,document.head.appendChild(d)}return Promise.all(t)},o.m=e,o.c=a,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(r,a,function(t){return e[t]}.bind(null,a));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/vue-forum/",o.oe=function(e){throw console.error(e),e};var i=window["webpackJsonp"]=window["webpackJsonp"]||[],d=i.push.bind(i);i.push=t,i=i.slice();for(var b=0;b<i.length;b++)t(i[b]);var l=d;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"0098":function(e,t,r){},"12ab":function(e,t,r){},"1a80":function(e,t,r){"use strict";r("48b9")},"2daa":function(e,t,r){"use strict";r("0098")},"2fa3":function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return d}));r("d3b7");var a=r("bc3a"),n=r.n(a),c=r("3d20"),s=r.n(c),u="https://forum-express-api.herokuapp.com/api",o=n.a.create({baseURL:u});o.interceptors.request.use((function(e){var t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(function(e){return Promise.reject(e)}));var i=o,d=s.a.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})},4579:function(e,t,r){},"48b9":function(e,t,r){},"4cce":function(e,t,r){"use strict";var a=r("2fa3");t["a"]={getCurrentUser:function(){return a["b"].get("/get_current_user")},get:function(e){var t=e.userId;return a["b"].get("/users/".concat(t))},update:function(e){var t=e.userId,r=e.formData;return a["b"].put("/users/".concat(t),r)},addFavorite:function(e){var t=e.restaurantId;return a["b"].post("/favorite/".concat(t),null)},deleteFavorite:function(e){var t=e.restaurantId;return a["b"].delete("/favorite/".concat(t))},addLike:function(e){var t=e.restaurantId;return a["b"].post("/like/".concat(t),null)},deleteLike:function(e){var t=e.restaurantId;return a["b"].delete("/like/".concat(t))},getTopUsers:function(){return a["b"].get("/users/top")},addFollowing:function(e){var t=e.userId;return a["b"].post("/following/".concat(t),null)},deleteFollowing:function(e){var t=e.userId;return a["b"].delete("/following/".concat(t))}}},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("7a23"),n=Object(a["H"])("data-v-2a7bb50b");Object(a["s"])("data-v-2a7bb50b");var c={id:"restaurant-forum"},s={role:"main",class:"bg-white mt-5"};Object(a["q"])();var u=n((function(e,t,r,n,u,o){var i=Object(a["w"])("Navbar"),d=Object(a["w"])("router-view");return Object(a["p"])(),Object(a["d"])("div",c,[Object(a["g"])(i),Object(a["g"])("main",s,[Object(a["g"])(d)])])})),o=(r("4989"),r("ab8b"),r("b0c0"),Object(a["H"])("data-v-554681f6"));Object(a["s"])("data-v-554681f6");var i={class:"navbar navbar-expand-lg fixed-top navbar-dark bg-dark"},d=Object(a["f"])(" 餐廳評論網 "),b=Object(a["g"])("button",{class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},[Object(a["g"])("span",{class:"navbar-toggler-icon"})],-1),l={id:"navbarSupportedContent",class:"navbar-collapse collapse"},p={class:"ml-auto d-flex align-items-center"},f=Object(a["f"])(" 管理員後台 ");Object(a["q"])();var g=o((function(e,t,r,n,c,s){var u=Object(a["w"])("router-link");return Object(a["p"])(),Object(a["d"])("nav",i,[Object(a["g"])(u,{class:"navbar-brand",to:"/"},{default:o((function(){return[d]})),_:1}),b,Object(a["g"])("div",l,[Object(a["g"])("div",p,[e.currentUser.isAdmin&&e.isAuthenticated?(Object(a["p"])(),Object(a["d"])(u,{key:0,to:"/admin",class:"text-white mr-3"},{default:o((function(){return[f]})),_:1})):Object(a["e"])("",!0),e.isAuthenticated?(Object(a["p"])(),Object(a["d"])(a["a"],{key:1},[Object(a["g"])(u,{to:{name:"user",params:{id:e.currentUser.id}},class:"text-white mr-3"},{default:o((function(){return[Object(a["f"])(Object(a["y"])(e.currentUser.name||"使用者")+" 您好 ",1)]})),_:1},8,["to"]),Object(a["g"])("button",{type:"button",class:"btn btn-sm btn-outline-success my-2 my-sm-0",onClick:t[1]||(t[1]=function(){return s.logout&&s.logout.apply(s,arguments)})}," 登出 ")],64)):Object(a["e"])("",!0)])])])})),m=r("5530"),v=r("5502"),h={computed:Object(m["a"])({},Object(v["b"])(["currentUser","isAuthenticated"])),methods:{logout:function(){this.$store.commit("revokeAuthentication"),this.$router.push("/signin")}}};r("1a80");h.render=g,h.__scopeId="data-v-554681f6";var j=h,O={components:{Navbar:j}};r("74d1");O.render=u,O.__scopeId="data-v-2a7bb50b";var k=O,y=r("1da1"),w=(r("96cf"),r("d3b7"),r("3ca3"),r("ddb0"),r("caad"),r("2532"),r("6c02"));function P(e,t){return Object(a["p"])(),Object(a["d"])("h1",null,"404 Not Found")}const x={};x.render=P;var I=x,R={class:"container py-5"},C=Object(a["g"])("div",{class:"text-center mb-4"},[Object(a["g"])("h1",{class:"h3 mb-3 font-weight-normal"}," Sign In ")],-1),_={class:"form-label-group mb-2"},q=Object(a["g"])("label",{for:"email"},"email",-1),A={class:"form-label-group mb-3"},S=Object(a["g"])("label",{for:"password"},"Password",-1),U={class:"text-center mb-3"},E=Object(a["f"])(" Sign Up "),L=Object(a["g"])("p",{class:"mt-5 mb-3 text-muted text-center"}," © 2017-2018 ",-1);function F(e,t,r,n,c,s){var u=Object(a["w"])("router-link");return Object(a["p"])(),Object(a["d"])("div",R,[Object(a["g"])("form",{class:"w-100",onSubmit:t[3]||(t[3]=Object(a["G"])((function(){return s.handleSubmit&&s.handleSubmit.apply(s,arguments)}),["prevent"]))},[C,Object(a["g"])("div",_,[q,Object(a["F"])(Object(a["g"])("input",{id:"email",name:"email",type:"email","onUpdate:modelValue":t[1]||(t[1]=function(e){return c.email=e}),class:"form-control",placeholder:"email",autocomplete:"username",autofocus:""},null,512),[[a["B"],c.email]])]),Object(a["g"])("div",A,[S,Object(a["F"])(Object(a["g"])("input",{id:"password","onUpdate:modelValue":t[2]||(t[2]=function(e){return c.password=e}),name:"password",type:"password",class:"form-control",placeholder:"Password",autocomplete:"current-password"},null,512),[[a["B"],c.password]])]),Object(a["g"])("button",{class:"btn btn-lg btn-primary btn-block mb-3",type:"submit",disabled:c.isProcessing}," Log In ",8,["disabled"]),Object(a["g"])("div",U,[Object(a["g"])("p",null,[Object(a["g"])(u,{to:"/signup"},{default:Object(a["E"])((function(){return[E]})),_:1})])]),L],32)])}var N=r("7696"),T=r("2fa3"),$={data:function(){return{email:"",password:"",isProcessing:!1}},methods:{handleSubmit:function(e){var t=this;return Object(y["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,t.email&&t.password){e.next=4;break}return T["a"].fire({icon:"warning",title:"請填入 email 和 password"}),e.abrupt("return");case 4:return t.isProcessing=!0,e.next=7,N["a"].signIn({email:t.email,password:t.password});case 7:if(r=e.sent,a=r.data,"success"===a.status){e.next=11;break}throw new Error(a.message);case 11:localStorage.setItem("token",a.token),t.$store.commit("setCurrentUser",a.user),t.$router.push("/restaurants"),e.next=22;break;case 16:e.prev=16,e.t0=e["catch"](0),t.password="",T["a"].fire({icon:"warning",title:"輸入的帳號密碼有誤"}),t.isProcessing=!1,console.log(e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,16]])})))()}}};$.render=F;var B=$,H={class:"container py-5"},G={class:"row"},M={key:1};function D(e,t,r,n,c,s){var u=Object(a["w"])("NavTabs"),o=Object(a["w"])("RestaurantsNavPills"),i=Object(a["w"])("RestaurantCard"),d=Object(a["w"])("RestaurantsPagination");return Object(a["p"])(),Object(a["d"])("div",H,[Object(a["g"])(u),Object(a["g"])(o,{categories:c.categories,"category-Id":c.categoryId},null,8,["categories","category-Id"]),Object(a["g"])("div",G,[(Object(a["p"])(!0),Object(a["d"])(a["a"],null,Object(a["v"])(c.restaurants,(function(e){return Object(a["p"])(),Object(a["d"])(i,{key:e.id,"initial-restaurant":e},null,8,["initial-restaurant"])})),128))]),c.totalPage.length>1?(Object(a["p"])(),Object(a["d"])(d,{key:0,"current-page":c.currentPage,"total-page":c.totalPage,"category-Id":c.categoryId,"previous-page":c.previousPage,"next-page":c.nextPage},null,8,["current-page","total-page","category-Id","previous-page","next-page"])):Object(a["e"])("",!0),c.restaurants.length<1?(Object(a["p"])(),Object(a["d"])("div",M," 此類別目前無餐廳資料 ")):Object(a["e"])("",!0)])}var J=r("8bb1"),V=(r("a4d3"),r("e01a"),{class:"col-md-6 col-lg-4"}),z={class:"card mb-4"},K={class:"card-body"},W={class:"card-text title-wrap"},Q={class:"badge badge-secondary"},X={class:"card-text text-truncate"},Y={class:"card-footer"};function Z(e,t,r,n,c,s){var u=Object(a["w"])("router-link");return Object(a["p"])(),Object(a["d"])("div",V,[Object(a["g"])("div",z,[Object(a["g"])("img",{class:"card-img-top",src:c.restaurant.image,alt:"Card image cap",width:"",height:""},null,8,["src"]),Object(a["g"])("div",K,[Object(a["g"])("p",W,[Object(a["g"])(u,{to:{name:"restaurant",params:{id:c.restaurant.id}}},{default:Object(a["E"])((function(){return[Object(a["f"])(Object(a["y"])(c.restaurant.name),1)]})),_:1},8,["to"])]),Object(a["g"])("span",Q,Object(a["y"])(c.restaurant.Category?c.restaurant.Category.name:"未分類"),1),Object(a["g"])("p",X,Object(a["y"])(c.restaurant.description),1)]),Object(a["g"])("div",Y,[c.restaurant.isFavorited?(Object(a["p"])(),Object(a["d"])("button",{key:0,disabled:c.isProcessing,onClick:t[1]||(t[1]=Object(a["G"])((function(e){return s.deleteFavorite(c.restaurant.id)}),["stop","prevent"])),type:"button",class:"btn btn-danger btn-border favorite mr-2"}," 移除最愛 ",8,["disabled"])):(Object(a["p"])(),Object(a["d"])("button",{key:1,disabled:c.isProcessing,onClick:t[2]||(t[2]=Object(a["G"])((function(e){return s.addFavorite(c.restaurant.id)}),["stop","prevent"])),type:"button",class:"btn btn-primary btn-border favorite mr-2"}," 加到最愛 ",8,["disabled"])),c.restaurant.isLiked?(Object(a["p"])(),Object(a["d"])("button",{key:2,disabled:c.isProcessing,onClick:t[3]||(t[3]=Object(a["G"])((function(e){return s.deleteLike(c.restaurant.id)}),["stop","prevent"])),type:"button",class:"btn btn-danger like mr-2"}," Unlike ",8,["disabled"])):(Object(a["p"])(),Object(a["d"])("button",{key:3,disabled:c.isProcessing,onClick:t[4]||(t[4]=Object(a["G"])((function(e){return s.addLike(c.restaurant.id)}),["stop","prevent"])),type:"button",class:"btn btn-primary like mr-2"}," Like ",8,["disabled"]))])])])}var ee=r("4cce"),te={props:{initialRestaurant:{type:Object,required:!0}},data:function(){return{restaurant:this.initialRestaurant,isProcessing:!1}},methods:{addFavorite:function(e){var t=this;return Object(y["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isProcessing=!0,r.next=4,ee["a"].addFavorite({restaurantId:e});case 4:if(a=r.sent,n=a.data,"success"===n.status){r.next=8;break}throw new Error(n.message);case 8:t.restaurant=Object(m["a"])(Object(m["a"])({},t.restaurant),{},{isFavorited:!0}),t.isProcessing=!1,r.next=17;break;case 12:r.prev=12,r.t0=r["catch"](0),console.log("error",r.t0),t.isProcessing=!1,T["a"].fire({icon:"error",title:"無法將餐廳加入最愛，請稍後再試"});case 17:case"end":return r.stop()}}),r,null,[[0,12]])})))()},deleteFavorite:function(e){var t=this;return Object(y["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isProcessing=!0,r.next=4,ee["a"].deleteFavorite({restaurantId:e});case 4:if(a=r.sent,n=a.data,"success"===n.status){r.next=8;break}throw new Error(n.message);case 8:t.restaurant=Object(m["a"])(Object(m["a"])({},t.restaurant),{},{isFavorited:!1}),t.isProcessing=!1,r.next=17;break;case 12:r.prev=12,r.t0=r["catch"](0),console.log("error",r.t0),t.isProcessing=!1,T["a"].fire({icon:"error",title:"無法將餐廳從最愛清單移除，請稍後再試"});case 17:case"end":return r.stop()}}),r,null,[[0,12]])})))()},addLike:function(e){var t=this;return Object(y["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isProcessing=!0,r.next=4,ee["a"].addLike({restaurantId:e});case 4:if(a=r.sent,n=a.data,"success"===n.status){r.next=8;break}throw new Error(n.message);case 8:t.restaurant=Object(m["a"])(Object(m["a"])({},t.restaurant),{},{isLiked:!0}),t.isProcessing=!1,r.next=17;break;case 12:r.prev=12,r.t0=r["catch"](0),t.isProcessing=!1,console.log("error",r.t0),T["a"].fire({icon:"error",title:"無法對餐廳按讚，請稍後再試"});case 17:case"end":return r.stop()}}),r,null,[[0,12]])})))()},deleteLike:function(e){var t=this;return Object(y["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isProcessing=!0,r.next=4,ee["a"].deleteLike({restaurantId:e});case 4:if(a=r.sent,n=a.data,"success"===n.status){r.next=8;break}throw new Error(n.message);case 8:t.restaurant=Object(m["a"])(Object(m["a"])({},t.restaurant),{},{isLiked:!1}),t.isProcessing=!1,r.next=17;break;case 12:r.prev=12,r.t0=r["catch"](0),t.isProcessing=!1,console.log("error",r.t0),T["a"].fire({icon:"error",title:"無法取消讚，請稍後再試"});case 17:case"end":return r.stop()}}),r,null,[[0,12]])})))()}}};te.render=Z;var re=te,ae=(r("2ca0"),Object(a["H"])("data-v-1c2d0fd5"));Object(a["s"])("data-v-1c2d0fd5");var ne={class:"nav nav-pills mb-4"},ce={class:"nav-item"},se=Object(a["f"])(" 全部 ");Object(a["q"])();var ue=ae((function(e,t,r,n,c,s){var u=Object(a["w"])("router-link");return Object(a["p"])(),Object(a["d"])("ul",ne,[Object(a["g"])("li",ce,[Object(a["g"])(u,{class:["nav-link",e.$route.fullPath==="/".concat(e.$route.name)?"active":""],to:{name:"restaurants"},"exact-active-class":""},{default:ae((function(){return[se]})),_:1},8,["class"])]),(Object(a["p"])(!0),Object(a["d"])(a["a"],null,Object(a["v"])(r.categories,(function(t){return Object(a["p"])(),Object(a["d"])("li",{key:t.id,class:"nav-item"},[Object(a["g"])(u,{class:["nav-link",e.$route.fullPath.startsWith("/".concat(e.$route.name))&&e.$route.query.categoryId==t.id?"active":""],to:{path:"restaurants",query:{categoryId:t.id}},"exact-active-class":""},{default:ae((function(){return[Object(a["f"])(Object(a["y"])(t.name),1)]})),_:2},1032,["to","class"])])})),128))])})),oe=(r("a9e3"),{props:{categories:{type:Array,required:!0},categoryId:{type:[String,Number],default:""}}});r("c77a");oe.render=ue,oe.__scopeId="data-v-1c2d0fd5";var ie=oe,de=Object(a["H"])("data-v-3edba8ad");Object(a["s"])("data-v-3edba8ad");var be={"aria-label":"Page navigation example"},le={class:"pagination"},pe=Object(a["g"])("span",{"aria-hidden":"true"},"«",-1),fe=Object(a["g"])("span",{"aria-hidden":"true"},"»",-1);Object(a["q"])();var ge=de((function(e,t,r,n,c,s){var u=Object(a["w"])("router-link");return Object(a["p"])(),Object(a["d"])("nav",be,[Object(a["g"])("ul",le,[Object(a["g"])("li",{class:["page-item",{disabled:1===r.currentPage}]},[Object(a["g"])(u,{class:"page-link","aria-label":"Previous",to:{name:"restaurants",query:{categoryId:r.categoryId,page:r.previousPage}}},{default:de((function(){return[pe]})),_:1},8,["to"])],2),(Object(a["p"])(!0),Object(a["d"])(a["a"],null,Object(a["v"])(r.totalPage,(function(e){return Object(a["p"])(),Object(a["d"])("li",{class:["page-item",["page-item",{active:r.currentPage===e}]],key:e},[Object(a["g"])(u,{class:"page-link",to:{name:"restaurants",query:{page:e,categoryId:r.categoryId}}},{default:de((function(){return[Object(a["f"])(Object(a["y"])(e),1)]})),_:2},1032,["to"])],2)})),128)),Object(a["g"])("li",{class:["page-item",{disabled:r.currentPage===r.totalPage.length}]},[Object(a["g"])(u,{class:"page-link","aria-label":"Next",to:{name:"restaurants",query:{categoryId:r.categoryId,page:r.nextPage}}},{default:de((function(){return[fe]})),_:1},8,["to"])],2)])])})),me={name:"RestaurantsPagination",props:{categoryId:{type:[String,Number],default:""},currentPage:{type:Number,default:1},totalPage:{type:Array,required:!0},previousPage:{type:Number,required:!0},nextPage:{type:Number,required:!0}}};r("fbae");me.render=ge,me.__scopeId="data-v-3edba8ad";var ve=me,he=r("c4c3"),je={name:"Restaurants",components:{NavTabs:J["a"],RestaurantCard:re,RestaurantsNavPills:ie,RestaurantsPagination:ve},data:function(){return{restaurants:[],categories:[],categoryId:-1,currentPage:1,totalPage:[],previousPage:-1,nextPage:-1}},created:function(){var e=this.$route.query,t=e.page,r=void 0===t?"":t,a=e.categoryId,n=void 0===a?"":a;this.fetchRestaurants({queryPage:r,queryCategoryId:n})},beforeRouteUpdate:function(e,t,r){var a=e.query,n=a.page,c=void 0===n?"":n,s=a.categoryId,u=void 0===s?"":s;this.fetchRestaurants({queryPage:c,queryCategoryId:u}),r()},methods:{fetchRestaurants:function(e){var t=this;return Object(y["a"])(regeneratorRuntime.mark((function r(){var a,n,c,s,u,o,i,d,b,l,p;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.queryPage,n=e.queryCategoryId,r.prev=1,r.next=4,he["a"].getRestaurants({page:a,categoryId:n});case 4:c=r.sent,s=c.data,u=s.restaurants,o=s.categories,i=s.categoryId,d=s.page,b=s.totalPage,l=s.prev,p=s.next,t.restaurants=u,t.categoryId=i,t.categories=o,t.currentPage=d,t.totalPage=b,t.previousPage=l,t.nextPage=p,r.next=19;break;case 15:r.prev=15,r.t0=r["catch"](1),console.log("error",r.t0),T["a"].fire({icon:"error",title:"無法取得餐廳資料，請稍後再試"});case 19:case"end":return r.stop()}}),r,null,[[1,15]])})))()}}};je.render=D;var Oe=je,ke=Object(v["a"])({state:{currentUser:{id:1,name:"",email:"",image:"",isAdmin:!1},isAuthenticated:!1,token:""},mutations:{setCurrentUser:function(e,t){e.currentUser=Object(m["a"])(Object(m["a"])({},e.currentUser),t),e.isAuthenticated=!0,e.token=localStorage.getItem("token")},revokeAuthentication:function(e){e.currentUser={},e.isAuthenticated=!1,e.token="",localStorage.removeItem("token")}},actions:{fetchCurrentUser:function(e){return Object(y["a"])(regeneratorRuntime.mark((function t(){var r,a,n,c,s,u,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,t.prev=1,t.next=4,ee["a"].getCurrentUser();case 4:if(a=t.sent,n=a.data,"error"!==n.status){t.next=8;break}throw new Error(n.message);case 8:return c=n.id,s=n.name,u=n.email,o=n.image,i=n.isAdmin,r("setCurrentUser",{id:c,name:s,email:u,image:o,isAdmin:i}),console.log("data",n),t.abrupt("return",!0);case 14:return t.prev=14,t.t0=t["catch"](1),console.log(t.t0.message),r("revokeAuthentication"),t.abrupt("return",!1);case 19:case"end":return t.stop()}}),t,null,[[1,14]])})))()}},modules:{},plugins:[]}),ye=function(e,t,r){var a=ke.state.currentUser;!a||a.isAdmin?r():r("/not-found")},we=[{path:"/",name:"root",redirect:"/signin"},{path:"/signin",name:"sign-in",component:B},{path:"/signup",name:"sign-up",component:function(){return r.e("chunk-2d0d338e").then(r.bind(null,"5c9c"))}},{path:"/restaurants",name:"restaurants",component:Oe},{path:"/restaurants/feeds",name:"restaurants-feeds",component:function(){return Promise.all([r.e("chunk-5ac8fa57"),r.e("chunk-3b6de194")]).then(r.bind(null,"9cab"))}},{path:"/restaurants/top",name:"restaurants-top",component:function(){return r.e("chunk-6ca49a1e").then(r.bind(null,"571a"))}},{path:"/users/top",name:"users-top",component:function(){return r.e("chunk-d55d3ce2").then(r.bind(null,"22ab"))}},{path:"/users/:id",name:"user",component:function(){return r.e("chunk-2d0ab43a").then(r.bind(null,"1511"))}},{path:"/users/:id/edit",name:"user-edit",component:function(){return r.e("chunk-2d228901").then(r.bind(null,"da5c"))}},{path:"/restaurants/:id",name:"restaurant",component:function(){return Promise.all([r.e("chunk-5ac8fa57"),r.e("chunk-1840e7d8")]).then(r.bind(null,"ad68"))}},{path:"/restaurants/:id/dashboard",name:"restaurant-dashboard",component:function(){return r.e("chunk-295109e3").then(r.bind(null,"9409"))}},{path:"/admin",exact:!0,redirect:"/admin/restaurants"},{path:"/admin/restaurants",name:"admin-restaurants",component:function(){return r.e("chunk-0ebdf657").then(r.bind(null,"73a3"))},beforeEnter:ye},{path:"/admin/restaurants/new",name:"admin-restaurant-new",component:function(){return r.e("chunk-c002a722").then(r.bind(null,"2743"))},beforeEnter:ye},{path:"/admin/restaurants/:id/edit",name:"admin-restaurant-edit",component:function(){return r.e("chunk-3c50f41a").then(r.bind(null,"6945"))},beforeEnter:ye},{path:"/admin/restaurants/:id",name:"admin-restaurant",component:function(){return r.e("chunk-3f0a9877").then(r.bind(null,"f91c"))},beforeEnter:ye},{path:"/admin/categories",name:"admin-categories",component:function(){return r.e("chunk-bb69456a").then(r.bind(null,"5652"))},beforeEnter:ye},{path:"/admin/users",name:"admin-users",component:function(){return r.e("chunk-05fcd4b4").then(r.bind(null,"6135"))},beforeEnter:ye},{path:"/:catchAll(.*)",name:"not-found",component:I,meta:{requireAuth:!1}}],Pe=Object(w["a"])({linkExactActiveClass:"active",history:Object(w["b"])(),routes:we});Pe.beforeEach(function(){var e=Object(y["a"])(regeneratorRuntime.mark((function e(t,r,a){var n,c,s,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=localStorage.getItem("token"),c=ke.state.token,s=ke.state.isAuthenticated,!n||n===c){e.next=7;break}return e.next=6,ke.dispatch("fetchCurrentUser");case 6:s=e.sent;case 7:if(u=["sign-in","sign-up"],s||u.includes(t.name)){e.next=11;break}return a("/signin"),e.abrupt("return");case 11:if(!s||!u.includes(t.name)){e.next=14;break}return a("/restaurants"),e.abrupt("return");case 14:a();case 15:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}());var xe=Pe;r("12ab");Object(a["c"])(k).use(ke).use(xe).mount("#app")},6150:function(e,t,r){},"74d1":function(e,t,r){"use strict";r("6150")},7696:function(e,t,r){"use strict";var a=r("5530"),n=r("2fa3");t["a"]={signIn:function(e){var t=e.email,r=e.password;return n["b"].post("/signin",{email:t,password:r})},signUp:function(e){return n["b"].post("/signup",Object(a["a"])({},e))}}},"8bb1":function(e,t,r){"use strict";var a=r("7a23"),n=Object(a["H"])("data-v-62553b17");Object(a["s"])("data-v-62553b17");var c={class:"nav nav-tabs mb-4"};Object(a["q"])();var s=n((function(e,t,r,s,u,o){var i=Object(a["w"])("router-link");return Object(a["p"])(),Object(a["d"])("ul",c,[(Object(a["p"])(!0),Object(a["d"])(a["a"],null,Object(a["v"])(u.tabs,(function(e){return Object(a["p"])(),Object(a["d"])("li",{key:e.id,class:"nav-item"},[Object(a["g"])(i,{to:e.path,class:"nav-link"},{default:n((function(){return[Object(a["f"])(Object(a["y"])(e.title),1)]})),_:2},1032,["to"])])})),128))])})),u=r("11c1"),o={data:function(){return{tabs:[{id:Object(u["v4"])(),title:"首頁",path:"/restaurants"},{id:Object(u["v4"])(),title:"最新動態",path:"/restaurants/feeds"},{id:Object(u["v4"])(),title:"Top 10 人氣餐廳",path:"/restaurants/top"},{id:Object(u["v4"])(),title:"美食達人",path:"/users/top"}]}}};r("2daa");o.render=s,o.__scopeId="data-v-62553b17";t["a"]=o},c4c3:function(e,t,r){"use strict";r("2b3d"),r("d3b7"),r("3ca3"),r("ddb0"),r("25f0");var a=r("2fa3");t["a"]={getRestaurant:function(e){var t=e.restaurantId;return a["b"].get("/restaurants/".concat(t))},getRestaurants:function(e){var t=e.page,r=e.categoryId,n=new URLSearchParams({page:t,categoryId:r});return a["b"].get("/restaurants?".concat(n.toString()))},getFeeds:function(){return a["b"].get("/restaurants/feeds")},getTopRestaurants:function(){return a["b"].get("/restaurants/top")}}},c77a:function(e,t,r){"use strict";r("ce91")},ce91:function(e,t,r){},fbae:function(e,t,r){"use strict";r("4579")}});
//# sourceMappingURL=app.82e7d38e.js.map