(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c50f41a"],{"12b2":function(e,t,a){"use strict";a("b0c0"),a("a4d3"),a("e01a");var r=a("7a23"),n={class:"form-group"},s=Object(r["g"])("label",{for:"name"},"Name",-1),i={class:"form-group"},o=Object(r["g"])("label",{for:"categoryId"},"Category",-1),c=Object(r["g"])("option",{value:"",selected:"",disabled:""}," --請選擇-- ",-1),u={class:"form-group"},d=Object(r["g"])("label",{for:"tel"},"Tel",-1),l={class:"form-group"},g=Object(r["g"])("label",{for:"address"},"Address",-1),m={class:"form-group"},b=Object(r["g"])("label",{for:"opening-hours"},"Opening Hours",-1),f={class:"form-group"},p=Object(r["g"])("label",{for:"description"},"Description",-1),h={class:"form-group"},O=Object(r["g"])("label",{for:"image"},"Image",-1);function j(e,t,a,j,v,y){return Object(r["F"])((Object(r["p"])(),Object(r["d"])("form",{onSubmit:t[8]||(t[8]=Object(r["G"])((function(){return y.handleSubmit&&y.handleSubmit.apply(y,arguments)}),["stop","prevent"]))},[Object(r["g"])("div",n,[s,Object(r["F"])(Object(r["g"])("input",{id:"name","onUpdate:modelValue":t[1]||(t[1]=function(e){return v.restaurant.name=e}),type:"text",class:"form-control",name:"name",placeholder:"Enter name"},null,512),[[r["B"],v.restaurant.name]])]),Object(r["g"])("div",i,[o,Object(r["F"])(Object(r["g"])("select",{id:"categoryId","onUpdate:modelValue":t[2]||(t[2]=function(e){return v.restaurant.categoryId=e}),class:"form-control",name:"categoryId"},[c,(Object(r["p"])(!0),Object(r["d"])(r["a"],null,Object(r["v"])(v.categories,(function(e){return Object(r["p"])(),Object(r["d"])("option",{key:e.id,value:e.id},Object(r["y"])(e.name),9,["value"])})),128))],512),[[r["A"],v.restaurant.categoryId]])]),Object(r["g"])("div",u,[d,Object(r["F"])(Object(r["g"])("input",{id:"tel","onUpdate:modelValue":t[3]||(t[3]=function(e){return v.restaurant.tel=e}),type:"text",class:"form-control",name:"tel",placeholder:"Enter telephone number"},null,512),[[r["B"],v.restaurant.tel]])]),Object(r["g"])("div",l,[g,Object(r["F"])(Object(r["g"])("input",{id:"address","onUpdate:modelValue":t[4]||(t[4]=function(e){return v.restaurant.address=e}),type:"text",class:"form-control",placeholder:"Enter address",name:"address"},null,512),[[r["B"],v.restaurant.address]])]),Object(r["g"])("div",m,[b,Object(r["F"])(Object(r["g"])("input",{id:"opening-hours","onUpdate:modelValue":t[5]||(t[5]=function(e){return v.restaurant.opening_hours=e}),type:"time",class:"form-control",name:"opening_hours"},null,512),[[r["B"],v.restaurant.opening_hours]])]),Object(r["g"])("div",f,[p,Object(r["F"])(Object(r["g"])("textarea",{id:"description","onUpdate:modelValue":t[6]||(t[6]=function(e){return v.restaurant.description=e}),class:"form-control",rows:"3",name:"description"},null,512),[[r["B"],v.restaurant.description]])]),Object(r["g"])("div",h,[O,v.restaurant.image?(Object(r["p"])(),Object(r["d"])("img",{key:0,class:"d-block img-thumbnail mb-3",width:"500",height:"auto",src:v.restaurant.image},null,8,["src"])):Object(r["e"])("",!0),Object(r["g"])("input",{id:"image",type:"file",name:"image",accept:"image/*",class:"form-control-file",onChange:t[7]||(t[7]=function(){return y.handleFileChange&&y.handleFileChange.apply(y,arguments)})},null,32)]),Object(r["g"])("button",{type:"submit",class:"btn btn-primary",disabled:a.isProcessing},Object(r["y"])(a.isProcessing?"處理中":"送出"),9,["disabled"])],544)),[[r["C"],!v.isLoading]])}var v=a("1da1"),y=a("5530"),w=(a("2b3d"),a("d3b7"),a("3ca3"),a("ddb0"),a("96cf"),a("be6c")),R=a("2fa3"),I={name:"AdminRestaurantForm",props:{initialRestaurant:{type:Object,default:function(){return{name:"",categoryId:"",tel:"",address:"",description:"",image:"",openingHours:""}}},isProcessing:{type:Boolean,default:!1}},data:function(){return{categories:[],restaurant:Object(y["a"])({},this.initialRestaurant),isLoading:!0}},created:function(){this.fetchCategories()},watch:{initialRestaurant:function(e,t){console.log("watch",{newValue:e,oldValue:t}),this.restaurant=Object(y["a"])(Object(y["a"])({},this.restaurant),e)}},beforeRouteUpdate:function(e,t,a){console.log("beforeRouteUpdate",{to:e,from:t});var r=e.params.id;this.fetchRestaurant(r)},methods:{fetchCategories:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,w["a"].categories.get();case 3:a=t.sent,r=a.data,e.categories=r.categories,e.isLoading=!1,t.next=14;break;case 9:t.prev=9,t.t0=t["catch"](0),e.isLoading=!0,console.log(t.t0.massege),R["a"].fire({icon:"error",title:"無法取得餐廳類別，請稍後再試"});case 14:case"end":return t.stop()}}),t,null,[[0,9]])})))()},handleFileChange:function(e){var t=e.target.files;if(console.log("files",t),0===t.length)this.restaurant.image="";else{var a=window.URL.createObjectURL(t[0]);console.log("imageURL",a),this.restaurant.image=a}},handleSubmit:function(e){if(this.restaurant.name)if(this.restaurant.categoryId){var t=e.target,a=new FormData(t);this.$emit("after-submit",a)}else R["a"].fire({icon:"warning",title:"請選擇餐廳類別"});else R["a"].fire({icon:"warning",title:"請填寫餐廳名稱"})}}};I.render=j;t["a"]=I},6945:function(e,t,a){"use strict";a.r(t);var r=a("7a23"),n={class:"container py-5"};function s(e,t,a,s,i,o){var c=Object(r["w"])("AdminRestaurantForm");return Object(r["p"])(),Object(r["d"])("div",n,[Object(r["g"])(c,{"initial-restaurant":i.restaurant,isProcessing:i.isProcessing,onAfterSubmit:o.handleAfterSubmit},null,8,["initial-restaurant","isProcessing","onAfterSubmit"])])}var i=a("5530"),o=a("1da1"),c=(a("96cf"),a("b0c0"),a("a4d3"),a("e01a"),a("12b2")),u=a("be6c"),d=a("2fa3"),l={name:"AdminRestaurantEdit",components:{AdminRestaurantForm:c["a"]},data:function(){return{restaurant:{id:-1,name:"",categoryId:"",tel:"",address:"",description:"",image:"",openingHours:""},isProcessing:!1}},created:function(){var e=this.$route.params.id;this.fetchRestaurant(e)},methods:{fetchRestaurant:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,n,s,o,c,l,g,m,b,f,p;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,u["a"].restaurants.getDetail({restaurantId:e});case 3:r=a.sent,n=r.data,s=n.restaurant,o=s.id,c=s.name,l=s.tel,g=s.address,m=s.openingHours,b=s.description,f=s.image,p=s.CategoryId,t.restaurant=Object(i["a"])(Object(i["a"])({},t.restaurant),{},{id:o,name:c,tel:l,address:g,openingHours:m,description:b,image:f,categoryId:p}),a.next=13;break;case 9:a.prev=9,a.t0=a["catch"](0),console.log(a.t0),d["a"].fire({icon:"error",title:"無法取得餐廳資料，請稍後再試"});case 13:case"end":return a.stop()}}),a,null,[[0,9]])})))()},handleAfterSubmit:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,t.isProcessing=!0,a.next=4,u["a"].restaurants.update({restaurantId:t.restaurant.id,formData:e});case 4:if(r=a.sent,n=r.data,"success"===n.status){a.next=8;break}throw new Error(n.message);case 8:t.$router.push({name:"admin-restaurants"}),a.next=16;break;case 11:a.prev=11,a.t0=a["catch"](0),t.isProcessing=!1,console.log(a.t0),d["a"].fire({icon:"error",title:"無法更新餐廳資料，請稍後再試"});case 16:case"end":return a.stop()}}),a,null,[[0,11]])})))()}}};l.render=s;t["default"]=l},be6c:function(e,t,a){"use strict";a("b0c0");var r=a("2fa3");t["a"]={categories:{get:function(){return r["b"].get("/admin/categories")},create:function(e){var t=e.name;return r["b"].post("/admin/categories",{name:t})},update:function(e){var t=e.categoryId,a=e.name;return r["b"].put("/admin/categories/".concat(t),{name:a})},delete:function(e){var t=e.categoryId;return r["b"].delete("/admin/categories/".concat(t))}},restaurants:{create:function(e){var t=e.formData;return r["b"].post("/admin/restaurants",t)},get:function(){return r["b"].get("/admin/restaurants")},getDetail:function(e){var t=e.restaurantId;return r["b"].get("/admin/restaurants/".concat(t))},update:function(e){var t=e.restaurantId,a=e.formData;return r["b"].put("/admin/restaurants/".concat(t),a)},delete:function(e){var t=e.restaurantId;return r["b"].delete("/admin/restaurants/".concat(t))}},users:{get:function(){return r["b"].get("/admin/users")},update:function(e){var t=e.userId,a=e.isAdmin;return r["b"].put("/admin/users/".concat(t),{isAdmin:a})}}}}}]);
//# sourceMappingURL=chunk-3c50f41a.6fb58d59.js.map