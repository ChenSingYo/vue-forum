{"version":3,"sources":["webpack:///./src/components/AdminRestaurantForm.vue","webpack:///./src/components/AdminRestaurantForm.vue?713d","webpack:///./src/views/AdminRestaurantEdit.vue","webpack:///./src/views/AdminRestaurantEdit.vue?0775","webpack:///./src/apis/admin.js"],"names":["class","for","value","selected","disabled","handleSubmit","id","restaurant","name","type","placeholder","categoryId","categories","category","key","tel","address","opening_hours","description","rows","image","width","height","src","accept","handleFileChange","isProcessing","isLoading","props","initialRestaurant","Object","default","openingHours","Boolean","data","this","created","fetchCategories","watch","newValue","oldValue","console","log","beforeRouteUpdate","to","from","next","params","fetchRestaurant","methods","admin","get","massege","fire","icon","title","e","files","target","length","imageURL","window","URL","createObjectURL","form","formData","FormData","$emit","render","initial-restaurant","handleAfterSubmit","components","AdminRestaurantForm","$route","restaurantId","restaurants","getDetail","CategoryId","update","status","Error","message","$router","push","apiHelper","create","post","put","delete","users","userId","isAdmin"],"mappings":"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","file":"js/chunk-3c50f41a.6fb58d59.js","sourcesContent":["<template>\n  <form\n    v-show=\"!isLoading\"\n    @submit.stop.prevent=\"handleSubmit\">\n    <div class=\"form-group\">\n      <label for=\"name\">Name</label>\n      <input\n        id=\"name\"\n        v-model=\"restaurant.name\"\n        type=\"text\"\n        class=\"form-control\"\n        name=\"name\"\n        placeholder=\"Enter name\"\n      />\n    </div>\n    <div class=\"form-group\">\n      <label for=\"categoryId\">Category</label>\n      <select\n        id=\"categoryId\"\n        v-model=\"restaurant.categoryId\"\n        class=\"form-control\"\n        name=\"categoryId\"\n      >\n        <option value=\"\" selected disabled>\n          --請選擇--\n        </option>\n        <option\n          v-for=\"category in categories\"\n          :key=\"category.id\"\n          :value=\"category.id\"\n        >\n          {{ category.name }}\n        </option>\n      </select>\n    </div>\n\n    <div class=\"form-group\">\n      <label for=\"tel\">Tel</label>\n      <input\n        id=\"tel\"\n        v-model=\"restaurant.tel\"\n        type=\"text\"\n        class=\"form-control\"\n        name=\"tel\"\n        placeholder=\"Enter telephone number\"\n      />\n    </div>\n\n    <div class=\"form-group\">\n      <label for=\"address\">Address</label>\n      <input\n        id=\"address\"\n        v-model=\"restaurant.address\"\n        type=\"text\"\n        class=\"form-control\"\n        placeholder=\"Enter address\"\n        name=\"address\"\n      />\n    </div>\n\n    <div class=\"form-group\">\n      <label for=\"opening-hours\">Opening Hours</label>\n      <input\n        id=\"opening-hours\"\n        v-model=\"restaurant.opening_hours\"\n        type=\"time\"\n        class=\"form-control\"\n        name=\"opening_hours\"\n      />\n    </div>\n\n    <div class=\"form-group\">\n      <label for=\"description\">Description</label>\n      <textarea\n        id=\"description\"\n        v-model=\"restaurant.description\"\n        class=\"form-control\"\n        rows=\"3\"\n        name=\"description\"\n      />\n    </div>\n\n    <div class=\"form-group\">\n      <label for=\"image\">Image</label>\n      <img\n        v-if=\"restaurant.image\"\n        class=\"d-block img-thumbnail mb-3\"\n        width=\"500\"\n        height=\"auto\"\n        :src=\"restaurant.image\"\n        >\n      <input\n        id=\"image\"\n        type=\"file\"\n        name=\"image\"\n        accept=\"image/*\"\n        class=\"form-control-file\"\n        @change=\"handleFileChange\"\n      />\n    </div>\n\n    <button\n      type=\"submit\"\n      class=\"btn btn-primary\"\n      :disabled=\"isProcessing\"\n    >\n    {{ isProcessing ? '處理中' : '送出' }}\n    </button>\n  </form>\n</template>\n\n<script>\nimport adminAPI from './../apis/admin'\nimport { Toast } from './../utils/helpers'\n\nexport default {\n  name: 'AdminRestaurantForm',\n  props: {\n    initialRestaurant: {\n      type: Object,\n      // 或是用小括號把物件包起來 () => ({})\n      default: () => {\n        return {\n          name: '',\n          categoryId: '',\n          tel: '',\n          address: '',\n          description: '',\n          image: '',\n          openingHours: ''\n        }\n      }\n    },\n    isProcessing: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data () {\n    return {\n      categories: [],\n      restaurant: {\n        ...this.initialRestaurant\n      },\n      isLoading: true\n    }\n  },\n  created () {\n    this.fetchCategories()\n  },\n  watch: {\n    initialRestaurant (newValue, oldValue) {\n      console.log('watch', { newValue, oldValue })\n      this.restaurant = {\n        ...this.restaurant,\n        ...newValue\n      }\n    }\n  },\n  beforeRouteUpdate (to, from, next) {\n    console.log('beforeRouteUpdate', { to, from })\n    const { id } = to.params\n    this.fetchRestaurant(id)\n  },\n  methods: {\n    async fetchCategories () {\n      try {\n        const { data } = await adminAPI.categories.get()\n        this.categories = data.categories\n        this.isLoading = false\n      } catch (e) {\n        this.isLoading = true\n        console.log(e.massege)\n        Toast.fire({\n          icon: 'error',\n          title: '無法取得餐廳類別，請稍後再試'\n        })\n      }\n    },\n    handleFileChange (e) {\n      const { files } = e.target\n      console.log('files', files)\n      if (files.length === 0) {\n        this.restaurant.image = ''\n      } else {\n        const imageURL = window.URL.createObjectURL(files[0])\n        console.log('imageURL', imageURL)\n        this.restaurant.image = imageURL\n      }\n    },\n    handleSubmit (e) {\n      if (!this.restaurant.name) {\n        Toast.fire({\n          icon: 'warning',\n          title: '請填寫餐廳名稱'\n        })\n        return\n      }\n      if (!this.restaurant.categoryId) {\n        Toast.fire({\n          icon: 'warning',\n          title: '請選擇餐廳類別'\n        })\n        return\n      }\n      const form = e.target\n      const formData = new FormData(form)\n      this.$emit('after-submit', formData)\n    }\n  }\n}\n</script>\n","import { render } from \"./AdminRestaurantForm.vue?vue&type=template&id=cb890306\"\nimport script from \"./AdminRestaurantForm.vue?vue&type=script&lang=js\"\nexport * from \"./AdminRestaurantForm.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <div class=\"container py-5\">\n    <AdminRestaurantForm\n      :initial-restaurant=\"restaurant\"\n      :isProcessing=\"isProcessing\"\n      @after-submit=\"handleAfterSubmit\"\n    />\n  </div>\n</template>\n\n<script>\nimport AdminRestaurantForm from './../components/AdminRestaurantForm'\nimport adminAPI from './../apis/admin'\nimport { Toast } from './../utils/helpers'\n\nexport default {\n  name: 'AdminRestaurantEdit',\n  components: {\n    AdminRestaurantForm\n  },\n  data () {\n    return {\n      restaurant: {\n        id: -1,\n        name: '',\n        categoryId: '',\n        tel: '',\n        address: '',\n        description: '',\n        image: '',\n        openingHours: ''\n      },\n      isProcessing: false\n    }\n  },\n  created () {\n    const { id } = this.$route.params\n    this.fetchRestaurant(id)\n  },\n  methods: {\n    async fetchRestaurant (restaurantId) {\n      try {\n        const { data } = await adminAPI.restaurants.getDetail({ restaurantId })\n        const {\n          id,\n          name,\n          tel,\n          address,\n          openingHours,\n          description,\n          image,\n          CategoryId: categoryId\n        } = data.restaurant\n        this.restaurant = {\n          ...this.restaurant,\n          id,\n          name,\n          tel,\n          address,\n          openingHours,\n          description,\n          image,\n          categoryId\n        }\n      } catch (e) {\n        console.log(e)\n        Toast.fire({\n          icon: 'error',\n          title: '無法取得餐廳資料，請稍後再試'\n        })\n      }\n    },\n    async handleAfterSubmit (formData) {\n      try {\n        this.isProcessing = true\n        const { data } = await adminAPI.restaurants.update({\n          restaurantId: this.restaurant.id,\n          formData\n        })\n        if (data.status !== 'success') {\n          throw new Error(data.message)\n        }\n        // 轉址動作\n        this.$router.push({ name: 'admin-restaurants' })\n      } catch (e) {\n        this.isProcessing = false\n        console.log(e)\n        Toast.fire({\n          icon: 'error',\n          title: '無法更新餐廳資料，請稍後再試'\n        })\n      }\n    }\n  }\n}\n</script>\n","import { render } from \"./AdminRestaurantEdit.vue?vue&type=template&id=7745cad5\"\nimport script from \"./AdminRestaurantEdit.vue?vue&type=script&lang=js\"\nexport * from \"./AdminRestaurantEdit.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { apiHelper } from './../utils/helpers'\n\nexport default {\n  categories: {\n    get () {\n      return apiHelper.get('/admin/categories')\n    },\n    create ({ name }) {\n      return apiHelper.post('/admin/categories', { name })\n    },\n    update ({ categoryId, name }) {\n      return apiHelper.put(`/admin/categories/${categoryId}`, { name })\n    },\n    delete ({ categoryId }) {\n      return apiHelper.delete(`/admin/categories/${categoryId}`)\n    }\n  },\n  restaurants: {\n    create ({ formData }) {\n      return apiHelper.post('/admin/restaurants', formData)\n    },\n    get () {\n      return apiHelper.get('/admin/restaurants')\n    },\n    getDetail ({ restaurantId }) {\n      return apiHelper.get(`/admin/restaurants/${restaurantId}`)\n    },\n    update ({ restaurantId, formData }) {\n      return apiHelper.put(`/admin/restaurants/${restaurantId}`, formData)\n    },\n    delete ({ restaurantId }) {\n      return apiHelper.delete(`/admin/restaurants/${restaurantId}`)\n    }\n  },\n  users: {\n    get () {\n      return apiHelper.get('/admin/users')\n    },\n    update ({ userId, isAdmin }) {\n      return apiHelper.put(`/admin/users/${userId}`, { isAdmin })\n    }\n  }\n}\n"],"sourceRoot":""}